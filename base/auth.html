<div id="auth">
  name yourself.(anonymous mode)
  <form>
    id:<input type="text" name="id" value="12345"/><br/>
    nick:<input type="text" name="nick" value="nickname"/><br/>
    <input type="submit" value="guest"/><br/>
  </form>
  <span id="error"></span>
</div>

<!-- 
       about the user identify logic, there are tables:
        record(user, {id, nick})
	record(auth, {key, user_id, email, password}) key={user_id, email}
        record(conn, {key, user_id, type, key}) key={user_id, type}
       a user could be identified by any conn or auth provider, for example:
        #user{id=12345, nick="username"}
        #auth{user_id=12345, email="username@163.com", password="pass"}
        #conn{user_id=12345, type=facebook, key="6123513"}
        #conn{user_id=12345, type=openid, key="username@openid.org"}
       user could verify himself via:
        facebook(conn) (againest the facebook connect api)
        openid(conn)   (againest the openid api)
        or by auth     (againest the data in auth tab)
       after any verify process, the user should be identify as the same one
       the key concept here is the #user, for a guest user, who should be:
        #user{id=undefined, nick="nickname"}
       for a authrized user, who should be:
        #user{id=12345, nick="username"}
-->

<style type="text/css">
</style>

<script language="javascript">
$(function(){
  // identify logic
  var callback = {
    success:function(){
      $("#auth form").unbind();
      ui.load("#root", "/base/main.html");
    },
    go_identify:function(){
      $("#auth form input:submit").removeAttr("disabled");
    },
    failure:function(error){
      $("#auth form input:submit").removeAttr("disabled");
      $("#auth #error").html("error:<hr/>"+error+"<hr/>");
    },
  };
  $("#auth form").bind("submit", function(event){
    $("input:submit", this).attr("disabled", true);
    con.open($("input:text", this).serialize(), callback);
    return false;
  });
});
</script>
